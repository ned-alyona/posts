<!DOCTYPE html>
<html lang="en">
<head>
    <title>Unit Testing in AngularJS with Karma & Jasmine</title>
    <meta charset="utf-8">
    <meta http-equiv="x-ua-compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="shower/themes/ribbon/styles/screen-16x10.css">
</head>
<body class="shower list">
    <header class="caption">
        <h1>Unit Testing in AngularJS with Karma & Jasmine</h1>
        <p>by Alyona Pysarenko</p>
    </header>

    <section class="slide" id="cover">
        <figure>
            <img class="cover" src="pictures/cover.png" alt="Karma and Jasmine">
        </figure>
        <h2>Unit Testing in AngularJS with Karma & Jasmine</h2>
        <p>by Alyona Pysarenko</p>
    </section>

    <section class="slide">
        <h2>Unit Testing: What and Why?</h2>
        <ol>
            <li>Proof of correctness</li>
            <li>Lack of compiler</li>
            <li>Catch errors early</li>
            <li>Prevent regressions</li>
        </ol>
    </section>

    <section class="slide slide-content-right karma-config">
        <figure class="pull-left">
            <img src="pictures/slide3.png" alt="Karma config">
        </figure>
        <div class="pull-right">
            <h2>Introduction to <br>Karma</h2>
            <p>Karma is the test runner that makes running tests painless and amazingly fast.</p>
            <p>Explaining the Karma Config:</p>
            <ol>
                <li>basePath</li>
                <li>frameworks</li>
                <li>files</li>
                <li>exclude</li>
                <li>port</li>
                <li>logLevel</li>
                <li>autoWatch</li>
                <li>browsers</li>
                <li>singleRun</li>
            </ol>
        </div>
    </section>

    <section class="slide files-option-karma">
        <div class="pull-left slide-content-left">
            <h2>“Files” Option in Karma</h2>
            <p>The list of files paths to load</p>
        </div>
        <figure class="pull-right">
            <img src="pictures/slide4.png" alt="Files Option in Karma">
        </figure>
    </section>

    <section class="slide run-specific-file">
        <div class="pull-left slide-content-left">
            <h2>Possibility to run specific file</h2>
            <p><i><b>getSpecs()</b> function</i></p>
        </div>
        <figure class="pull-right">
            <img src="pictures/slide5.png" alt="Possibility to run specific file">
        </figure>
    </section>

    <section class="slide karma-run">
        <h2>How to run and verify results?</h2>
        <p class="title-karma-start">Karma start</p>
        <figure class="karma-run-default">
            <img src="pictures/slide6_1.png" alt="Karma start">
        </figure>
        <p class="condensed-font">env KARMA_SPECS=“spec/online-mortgage/online-mortgage-strategy-controller.js” karma start</p>
        <p class="title-left">Success</p>
        <figure class="karma-run-success">
            <img src="pictures/slide6_2.png" alt="Karma start success">
        </figure>
        <p class="title-left">Failed</p>
        <figure class="karma-run-fail">
            <img src="pictures/slide6_3.png" alt="Karma start failed">
        </figure>
    </section>

    <section class="slide slide-content-right jasmine-spec-style">
        <figure class="pull-left">
            <img src="pictures/slide7.png" alt="Jasmine Spec Style">
        </figure>
        <div class="pull-right">
            <h2>Jasmine: Spec <br>Style of Testing</h2>
            <h3>Jasmine Syntax</h3>
            <ol>
                <li>describe</li>
                <li>beforeEach</li>
                <li>it</li>
                <li>afterEach</li>
                <li>expect</li>
            </ol>
            <h3>Useful Jasmine Matchers</h3>
            <ol class="double">
                <li>toEqual</li>
                <li>toBe</li>
                <li>toBeTruthy</li>
                <li>toBeFalsy</li>
                <li>toBeDefined</li>
                <li>toBeUndefined</li>
                <li>toBeNull</li>
                <li>toContain</li>
                <li>toMatch</li>
            </ol>
        </div>
    </section>

    <section class="slide mocking-services">
        <h2>Mocking Out Services</h2>
        <div class="double">
            <div>
                <p><i><b>Inline mock</b></i></p>
                <p>The first way is to override the service during the unit test, as an <b>inline mock</b></p>
            </div>
            <div>
                <p><i><b>Global mock</b></i></p>
                <p>The second option to override services would be at a <b>global level</b> instead of a unit test level.</p>
            </div>
        </div>
    </section>

    <section class="slide simple-service">
        <div class="pull-left slide-content-left">
            <h2>A Simple AngularJS Service</h2>
            <p><i>to mock out</i></p>
        </div>
        <figure class="pull-right">
            <img src="pictures/slide9.png" alt="A Simple AngularJS Service">
        </figure>
    </section>

    <section class="slide full-width-pic inline-service-mock">
        <h2>inline service mock</h2>
        <figure>
            <img src="pictures/slide10.png" alt="inline service mock">
        </figure>
    </section>

    <section class="slide slide-content-right global-service-mock">
        <figure class="pull-left">
            <img src="pictures/slide11.png" alt="Global Service mock">
        </figure>
        <div class="pull-right">
            <h2>Global Service mock</h2>
            <p>File: notesApp-mocks.js</p>
            <figure>
                <img src="pictures/slide11_2.png" alt="Global Service mock">
            </figure>
        </div>
    </section>

    <section class="slide slide-content-right spies">
        <figure class="pull-left">
            <img src="pictures/slide12.png" alt="Spies">
        </figure>
        <div class="pull-right">
            <h2>Spies</h2>
            <p>In Jasmine, mocks are referred to as spies.</p>
            <p>Spies allow us to hook into certain functions, and check whether they:</p>
            <ol>
                <li>were called</li>
                <li>how many times they were called</li>
                <li>what arguments they were called with</li>
                <li>define value that has to be retuned</li>
            </ol>
        </div>
    </section>

    <section class="slide full-width-pic init-function">
        <h2>Unit Testing Server Calls</h2>
        <p><i><b>init()</b> function in controller</i></p>
        <figure>
            <img src="pictures/slide13.png" alt="Unit Testing Server Calls">
        </figure>
    </section>

    <section class="slide unit-testing-server-calls slide-content-right">
        <figure class="pull-left">
            <img src="pictures/slide14.png" alt="Unit Testing Server Calls">
        </figure>
        <div class="pull-right">
            <h2>Unit Testing Server <br>Calls</h2>
            <p>The $http service internally uses the $httpBackend to make the actual XHR requests.</p>
            <p>The angular-mocks.js file provides a <b>mock $httpBackend service</b> that
            <ol>
                <li>prevents server calls</li>
                <li>gives us hooks to set expectations <i>mockBackend.expectGET(‘/api/note’).respond(200, mockGetResponse)</i></li>
                <li>allow to trigger responses  <i>flush()</i></li>
            </ol>
        </div>
    </section>

    <section class="slide full-width-pic">
        <h2>afterEach FUNCTIONS</h2>
        <div class="double">
            <div>
                <h3>verifyNoOutstandingRequests()</h3>
                <p>Ensure that all requests to the server have actually responded (using flush())</p>
            </div>
            <div>
                <h3>verifyNoOutstandingExpectations()</h3>
                <p>Ensure that all expects set on the $httpBackend were actually called</p>
            </div>
        </div>
        <figure>
            <img src="pictures/slide15.jpg" alt="afterEach FUNCTIONS">
        </figure>
    </section>

    <section class="slide issues">
        <h2>Issues we met</h2>
        <p>1. Syntax of private functions in controller</p>
        <figure>
            <img src="pictures/slide16.jpg" alt="Call private function in test">
        </figure>
    </section>

    <section class="slide issues">
        <h2>Issues we met</h2>
        <p>2. Mocking service that returns class with extended prototype</p>
        <figure>
            <img src="pictures/slide17.jpg" alt="Mocking service that returns class">
        </figure>
    </section>

    <section class="slide test-coverage">
        <h2>Test coverage</h2>
        <figure>
            <img src="pictures/slide18.jpg" alt="Test coverage">
        </figure>
    </section>

    <section class="slide thank-you">
        <h1>Thank you for your attention!</h1>
    </section>

    <div class="progress"></div>

    <script src="shower/shower.min.js"></script>
</body>
</html>
